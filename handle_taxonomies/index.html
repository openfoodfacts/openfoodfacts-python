
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://openfoodfacts.github.io/openfoodfacts-python/handle_taxonomies/">
      
      
        <link rel="prev" href="../usage/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.29">
    
    
      
        <title>Handle taxonomies - openfoodfacts-python</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.76a95c52.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#handle-taxonomies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="openfoodfacts-python" class="md-header__button md-logo" aria-label="openfoodfacts-python" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            openfoodfacts-python
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Handle taxonomies
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="openfoodfacts-python" class="md-nav__button md-logo" aria-label="openfoodfacts-python" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    openfoodfacts-python
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Handle taxonomies
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Handle taxonomies
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-information-about-a-taxonomy-item" class="md-nav__link">
    <span class="md-ellipsis">
      Get information about a taxonomy item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-taxonomy-object" class="md-nav__link">
    <span class="md-ellipsis">
      The Taxonomy object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Taxonomy object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-leaf-nodes-in-the-taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      Find leaf nodes in the taxonomy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-information-about-a-taxonomy-item" class="md-nav__link">
    <span class="md-ellipsis">
      Get information about a taxonomy item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-taxonomy-object" class="md-nav__link">
    <span class="md-ellipsis">
      The Taxonomy object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Taxonomy object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-leaf-nodes-in-the-taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      Find leaf nodes in the taxonomy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="handle-taxonomies">Handle taxonomies</h1>
<p>The Python SDK provides an easy way to access and handle the taxonomies available on Open Food Facts.</p>
<p>Taxonomies are at the heart of Open Food Facts. They are used to structure knowledge about ingredients, categories, labels, additives, countries, brands, etc.</p>
<p>To have a better understanding of how taxonomies work, you can read the <a href="https://wiki.openfoodfacts.org/Global_taxonomies">wiki page about taxonomies</a>.</p>
<h2 id="usage">Usage</h2>
<h3 id="get-information-about-a-taxonomy-item">Get information about a taxonomy item</h3>
<p>First, instantiate a Taxonomy object:</p>
<pre><code class="language-python">from openfoodfacts.taxonomy import get_taxonomy

# Use the singular form of the taxonomy name
taxonomy = get_taxonomy(&quot;category&quot;)
print(taxonomy)
# &lt;openfoodfacts.taxonomy.Taxonomy object at 0x7fe9d3f44940&gt;
</code></pre>
<p>The taxonomy object provides a way to access the taxonomy data. For example, if you want to get the node <code>en:biscuits</code>:</p>
<pre><code class="language-python">node = taxonomy[&quot;en:biscuits&quot;]
print(node)
# &lt;TaxonomyNode en:biscuits&gt;
</code></pre>
<p>If the node does not exist, <code>None</code> is returned.</p>
<p>You can get the the translation in a specific language:</p>
<pre><code class="language-python">print(node.get_localized_name(&quot;it&quot;))
# Biscotti
</code></pre>
<p>Each node has one or more parents, stored in the <code>parents</code> field:</p>
<pre><code class="language-python">print(node.parents)
# [&lt;TaxonomyNode en:biscuits-and-cakes&gt;]
</code></pre>
<p>Likewise, children can be accessed using the <code>children</code> field.</p>
<p>To get the full parent hierarchy (that includes all parents found recursively), use the <code>get_parents_hierarchy</code> method:</p>
<pre><code class="language-python">print(node.get_parents_hierarchy())
# [&lt;TaxonomyNode en:biscuits-and-cakes&gt;, &lt;TaxonomyNode en:sweet-snacks&gt;, &lt;TaxonomyNode en:snacks&gt;]
</code></pre>
<p>Beside the main translation that can be accessed using <code>get_localized_name</code>, each node may have synonyms. This information can be easily accessed as well:</p>
<pre><code class="language-python"># synonyms is a dict mapping language codes to a list of
# synonyms in that language. The key is missing if there are
# no synonyms.
print(node.synonyms[&quot;es&quot;])
# [&quot;Galletas&quot;, &quot;galleta&quot;]
</code></pre>
<p>Taxonomy node properties are stored in the <code>properties</code> field:</p>
<pre><code class="language-python">print(node.properties)
# {
#    &quot;wikipedia&quot;: {&quot;en&quot;: &quot;https://en.wikipedia.org/wiki/Biscuit&quot;},
#    &quot;carbon_footprint_fr_foodges_ingredient&quot;: {&quot;fr&quot;: &quot;Biscuit au beurre&quot;},
#    &quot;agribalyse_proxy_food_code&quot;: {&quot;en&quot;: &quot;24000&quot;},
#    &quot;ciqual_proxy_food_name&quot;: {
#        &quot;en&quot;: &quot;Biscuit -cookie-&quot;,
#        &quot;fr&quot;: &quot;Biscuit sec, sans précision&quot;,
#    },
#    &quot;wikidata&quot;: {&quot;en&quot;: &quot;Q13270&quot;},
#    &quot;ciqual_proxy_food_code&quot;: {&quot;en&quot;: &quot;24000&quot;},
#}
</code></pre>
<h3 id="the-taxonomy-object">The Taxonomy object</h3>
<p>The <code>Taxonomy</code> object is a dictionary-like object that maps node IDs to <code>TaxonomyNode</code> objects.</p>
<p>It also provides a way to iterate over all nodes:</p>
<pre><code class="language-python">for node in taxonomy.iter_nodes():
    print(node)
# &lt;TaxonomyNode fr:beaune-premier-cru-belissand-blanc&gt;
# &lt;TaxonomyNode fr:pommard-les-rugiens-bas&gt;
# &lt;TaxonomyNode en:hazelnut-butters&gt;
# &lt;TaxonomyNode fr:pernand-vergelesses&gt;
# &lt;TaxonomyNode it:terre-di-pisa&gt;
# &lt;TaxonomyNode en:creamy-quark&gt;
# ...
</code></pre>
<h4 id="find-leaf-nodes-in-the-taxonomy">Find leaf nodes in the taxonomy</h4>
<p>One very common usecase is to find the leafs nodes among a list of nodes, i.e. the nodes that have no children.
For example, in Open Food Facts, the <code>categories_tags</code> field contains the categories submitted by the user and all their parents. If you're only interested in the most precise categories, you need to filter out the categories that have children:</p>
<pre><code class="language-python"># Let's say you have a product that has the following categories:
categories_tags = [&quot;en:plant-based-foods-and-beverages&quot;,&quot;en:plant-based-foods&quot;,&quot;en:breakfasts&quot;,&quot;en:cereals-and-potatoes&quot;,&quot;en:fruits-and-vegetables-based-foods&quot;,&quot;en:cereals-and-their-products&quot;,&quot;en:fruits-based-foods&quot;,&quot;en:breakfast-cereals&quot;,&quot;en:mueslis&quot;,&quot;en:cereals-with-nuts&quot;,&quot;en:crunchy-cereal-clusters&quot;,&quot;en:cereal-clusters-with-nuts&quot;]

# Convert the ID to TaxonomyNode objects:
categories_nodes = [taxonomy[tag] for tag in categories_tags if tag in taxonomy]

# Let's find the leaf nodes using find_deepest_nodes method:
leaf_nodes = taxonomy.find_deepest_nodes(categories_nodes)
print(leaf_nodes)
# [&lt;TaxonomyNode en:fruits-based-foods&gt;, &lt;TaxonomyNode en:mueslis&gt;, &lt;TaxonomyNode en:cereal-clusters-with-nuts&gt;]
</code></pre>
<p>As you can see, the parent categories were removed, and only the leaf nodes remain.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>